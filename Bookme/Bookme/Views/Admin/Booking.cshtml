@model IEnumerable<Bookme.ViewModels.ApplicationUserViewModel>
@* @inject Bookme.IHelper.IUserHelper _userHelper *@

@{
    ViewData["Title"] = "Booking";
    Layout = "~/Views/Shared/_AdminLayout.cshtml";

    // var userId = Model.FirstOrDefault().Id;
    // var checkAvailable = _userHelper.CheckIfAvailable(userId);

}

<div id="main">
    @if (TempData["Message"] != null)
    {
        <div class="col-sm-6 col-xm-6 col-md-10 col-lg-10 col-xl-10 m-auto p-3">
            <div class="alert alert-success alert-dismissible fade show">
                <button type="button" class="close" data-dismiss="alert">&times;</button>
                <strong>Success!</strong> @TempData["Message"]
            </div>
        </div>
    }

    <div class="container">
        @if (Model.Count() > 0)
        {
           
            <div>
                @{
                    var group = @Model.GroupBy(x => x.CategoryName).ToList();
                }
                
                @foreach (var item in group)
                {
                    <div class="row" style="border-bottom:1px solid grey">

                        <h4 class="mt-3 col-12 text-center" style="color:#4a0000;"><b>@item.Key</b></h4>
                        @foreach (var categoryUser in item.Take(4))
                        {
                            <div class=" mb-3 mt-3 col-sm-12  col-lg-3" >

                                <div class=" card  mt-3 shadow mb-3" style="color:#4a0000;">
                                    @if (categoryUser.IsAvailable == true)
                                    {
                                        <a class=" badge badge-success mx-2 mt-3"> Available </a>
                                    }
                                    else
                                    {
                                        <a class=" badge badge-danger mx-2 mt-3"> Not Available </a>
                                    }
                                    @if(categoryUser.Image != null)
                                    {
                                        <img class="card-img-top rounded-circle mt-2 h-50 w-50 mx-auto" src="@categoryUser.Image">
                                    }
                                    else
                                    {
                                        <img class="card-img-top rounded-circle  mt-2 h-50 w-50 mx-auto" src="~/Images/dm.png">
                                    }

                                    <div class="card-body style=" color:#4a0000;"">
                                        <h4 class="card-title">@categoryUser.FirstName  @categoryUser.LastName</h4>
                                        <div>
                                            <p>
                                                <b>User Name:</b> @categoryUser.UserName <br />
                                                <b>Specialty:</b>   @categoryUser.MusicSpecialization  <br />
                                                <b>price:</b>  @categoryUser.Price
                                            </p>
                                        </div>
                                        @if (categoryUser.IsAvailable == true)
                                        {
                                            <a class="btn text-white" style="background-color:#4a0000;" asp-action="BookingForm" asp-controller="Admin" asp-route-id="@categoryUser.Id">Bookme</a>
                                            <a class="btn text-white float-right" style="background-color:#4a0000;" data-toggle="modal" data-target="#userDetails" onclick="viewBookedDetails('@categoryUser.Id')"><i class="fa fa-eye"></i></a>

                                        }
                                        else
                                        {
                                            <button class="btn text-white btn-outline-dark" style="background-color: black" disabled>Bookme</button>
                                            <a class="btn text-white float-right" style="background-color:#4a0000;" data-toggle="modal" data-target="#userDetails" onclick="viewBookedDetails('@categoryUser.Id')"><i class="fa fa-eye"></i></a>
                                        }
                                        <div>

                                        </div>
                                    </div>
                                </div>
                               
                            </div>

                        }
                        <div class="text-center col-12 mt-4 mb-4">
                            <a type="button" class="btn text-white mt-3" style="background-color:#4a0000;" asp-action="ViewMore" asp-controller="Admin" asp-route-categoryId="@item.FirstOrDefault().CategoryId"><b>View more</b></a>
                        </div>
                    </div>
                   
                }
               
            </div>
            
            
        }
        
        
    </div>
</div>



<div class="modal fade" id="userDetails" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content text-white">
            <div class="modal-header">
                <h5 class="modal-title text-dark"><b> User Profile </b></h5>
            </div>
            <div class="modal-body" id="userContent">
            </div>
        </div>
    </div>
</div>
